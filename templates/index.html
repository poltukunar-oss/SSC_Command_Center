<!-- ONLY BODY PART CHANGED LOGIC, FULL PREMIUM VERSION -->

<input type="file" id="img">

<script>
async function addScore(){
await fetch("/add_score",{method:"POST",headers:{'Content-Type':'application/json'},
body:JSON.stringify({
maths:parseInt(m.value),
english:parseInt(e.value),
reasoning:parseInt(r.value),
gs:parseInt(g.value)
})});
m.value=e.value=r.value=g.value="";
loadScores();
}

async function loadScores(){
let res=await fetch("/get_scores");
let data=await res.json();
chart.data.labels=data.map(x=>x[4]);
chart.data.datasets[0].data=data.map(x=>x[0]);
chart.data.datasets[1].data=data.map(x=>x[1]);
chart.data.datasets[2].data=data.map(x=>x[2]);
chart.data.datasets[3].data=data.map(x=>x[3]);
chart.update();
}

async function addError(){
let fd=new FormData();
fd.append("subject",sub.value);
fd.append("topic",topic.value);
fd.append("description",desc.value);
fd.append("image",img.files[0]);

await fetch("/add_error",{method:"POST",body:fd});
topic.value=""; desc.value=""; img.value="";
loadErrors();
}

async function loadErrors(){
let res=await fetch("/get_errors");
let data=await res.json();
errors.innerHTML="";
data.forEach(e=>{
errors.innerHTML+=`
<div class='error'>
<b>[${e[4]}] ${e[0]}</b> - ${e[1]}<br>${e[2]}<br>
${e[3] ? `<img src="/static/uploads/${e[3]}" width="100">` : ""}
</div>`;
});
}

loadScores();
loadErrors();
</script>
